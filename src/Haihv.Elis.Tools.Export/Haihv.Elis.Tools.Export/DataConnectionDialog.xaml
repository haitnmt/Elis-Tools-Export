<?xml version="1.0" encoding="utf-8"?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Haihv.Elis.Tools.Export.DataConnectionDialog"
             x:Name="DialogRoot">

    <!-- Overlay nền tối -->
    <Grid BackgroundColor="#80000000">
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Tapped="OnOverlayTapped"/>
        </Grid.GestureRecognizers>
        <!-- Dialog Container -->
        <Border BackgroundColor="White"
                StrokeThickness="0"
                StrokeShape="RoundRectangle 10"
                WidthRequest="500"
                VerticalOptions="Center"
                HorizontalOptions="Center"
                Padding="20">

            <Grid>
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnDialogTapped"/>
                </Grid.GestureRecognizers>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                </Grid.RowDefinitions>

                <!-- Header với nút đóng -->
                <Grid Grid.Row="0">
                    <Label Text="Cấu hình kết nối SQL Server"
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>

                    <Button Text="✕"
                            FontSize="16"
                            BackgroundColor="Transparent"
                            TextColor="Gray"
                            WidthRequest="30"
                            HeightRequest="30"
                            HorizontalOptions="End"
                            VerticalOptions="Start"
                            Clicked="OnCloseClicked"/>
                </Grid>

                <Label Grid.Row="2"
                       Text="Tên máy chủ SQL Server:"
                       FontSize="14"/>

                <Entry Grid.Row="4"
                       x:Name="ServerEntry"
                       Text="localhost"
                       Placeholder="Ví dụ: localhost, 192.168.1.100"
                       Focused="OnEntryFocused"/>

                <Label Grid.Row="6"
                       Text="Tên cơ sở dữ liệu:"
                       FontSize="14"/>

                <Entry Grid.Row="8"
                       x:Name="DatabaseEntry"
                       Text="ELIS"
                       Placeholder="Nhập tên database"
                       Focused="OnEntryFocused"/>

                <Label Grid.Row="10"
                       Text="Tên đăng nhập:"
                       FontSize="14"/>

                <Entry Grid.Row="12"
                       x:Name="UsernameEntry"
                       Text="sa"
                       Placeholder="Để trống nếu dùng Windows Authentication"
                       Focused="OnEntryFocused"/>

                <Label Grid.Row="14"
                       Text="Mật khẩu:"
                       FontSize="14"/>

                <Entry Grid.Row="16"
                       x:Name="PasswordEntry"
                       IsPassword="True"
                       Placeholder="Để trống nếu dùng Windows Authentication"
                       Focused="OnEntryFocused"/>

                <Grid Grid.Row="18">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0"
                            x:Name="TestButton"
                            Text="Kiểm tra kết nối"
                            BackgroundColor="#007ACC"
                            TextColor="White"
                            Clicked="OnTestConnectionClicked"/>

                    <Button Grid.Column="2"
                            Text="Đóng"
                            BackgroundColor="#6C757D"
                            TextColor="White"
                            Clicked="OnCloseClicked"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</ContentView>
