<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Haihv.Elis.Tools.App.Controls.ShareConnectionPage"
             Title="Lưu tệp kết nối">

    <Grid>
        <!-- Background overlay -->
        <BoxView BackgroundColor="Black"
                 Opacity="0.5"/>
        <!-- Main dialog -->
        <Border BackgroundColor="{AppThemeBinding Light=White, Dark=#2B2B2B}"
                Stroke="{AppThemeBinding Light=LightGray, Dark=Gray}"
                StrokeThickness="1"
                WidthRequest="450"
                HorizontalOptions="Center"
                VerticalOptions="Center">

            <Border.StrokeShape>
                <RoundRectangle CornerRadius="10"/>
            </Border.StrokeShape>

            <ScrollView>
                <VerticalStackLayout Padding="20"
                                     Spacing="15">
                    <!-- Title -->
                    <Label Text="💾 Lưu tệp kết nối"
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"/>
                    <!-- Phần tạo mật khẩu -->
                    <StackLayout x:Name="PasswordLayout"
                                 Spacing="10"
                                 IsVisible="True">
                        <Label Text="Mật khẩu mã hóa:"
                               FontSize="14"
                               FontAttributes="Bold"/>

                        <StackLayout Orientation="Horizontal"
                                     Spacing="10">
                            <RadioButton x:Name="AutoPasswordRadio"
                                         Content="Tạo tự động"
                                         IsChecked="True"/>
                            <RadioButton x:Name="ManualPasswordRadio"
                                         Content="Nhập thủ công"/>
                        </StackLayout>

                        <!-- Mật khẩu tự động -->
                        <StackLayout x:Name="AutoPasswordLayout"
                                     Spacing="5">
                            <Grid ColumnDefinitions="*,Auto">
                                <Entry x:Name="AutoPasswordEntry"
                                       Grid.Column="0"
                                       IsPassword="True"
                                       IsReadOnly="True"
                                       FontFamily="Consolas"
                                       Placeholder="Mật khẩu sẽ được tạo tự động"/>
                                <Button x:Name="CopyPasswordBtn"
                                        Grid.Column="1"
                                        Text="📋 Copy"
                                        Clicked="CopyPasswordBtn_Clicked"/>
                            </Grid>
                        </StackLayout>

                        <!-- Mật khẩu thủ công -->
                        <Entry x:Name="ManualPasswordEntry"
                               IsPassword="True"
                               Placeholder="Nhập mật khẩu mã hóa"
                               IsVisible="False"/>
                    </StackLayout>

                    <!-- Kết quả -->
                    <StackLayout x:Name="ResultLayout"
                                 Spacing="10"
                                 IsVisible="False">
                        <Label Text="✅ Lưu tệp thành công!"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="Green"
                               HorizontalOptions="Center"/>

                        <Border BackgroundColor="LightGray"
                                Padding="10"
                                Stroke="Gray"
                                StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="5"/>
                            </Border.StrokeShape>
                            <StackLayout Spacing="5">
                                <Label Text="Vị trí tệp:"
                                       FontAttributes="Bold"/>
                                <Label x:Name="FilePathLabel"
                                       FontFamily="Consolas"
                                       TextColor="Blue"/>
                            </StackLayout>
                        </Border>

                        <Grid ColumnDefinitions="*,*"
                              ColumnSpacing="10">
                            <Button x:Name="OpenLocationBtn"
                                    Grid.Column="0"
                                    Text="📁 Mở thư mục"
                                    Clicked="OpenLocationBtn_Clicked"/>
                            <Button x:Name="CloseBtn"
                                    Grid.Column="1"
                                    Text="Đóng"
                                    Clicked="CloseBtn_Clicked"/>
                        </Grid>
                    </StackLayout>
                    <!-- Tùy chọn không mã hóa - Chuyển xuống dưới -->
                    <StackLayout x:Name="EncryptionOptionsLayout"
                                 Spacing="10">
                        <StackLayout Orientation="Horizontal"
                                     Spacing="10">
                            <CheckBox x:Name="NoEncryptCheckBox"
                                      IsChecked="False"/>
                            <Label Text="Gửi tệp không mã hóa"
                                   VerticalOptions="Center"/>
                        </StackLayout>
                    </StackLayout>

                    <!-- Buttons -->
                    <Grid x:Name="ButtonsLayout"
                          ColumnDefinitions="*,*"
                          ColumnSpacing="10"
                          Margin="0,10,0,0">
                        <Button x:Name="CancelBtn"
                                Grid.Column="0"
                                Text="Hủy"
                                BackgroundColor="LightGray"
                                TextColor="Black"
                                Clicked="CancelBtn_Clicked"/>

                        <Button x:Name="SaveBtn"
                                Grid.Column="1"
                                Text="Lưu tệp"
                                BackgroundColor="DodgerBlue"
                                TextColor="White"
                                Clicked="SaveBtn_Clicked"/>
                    </Grid>
                </VerticalStackLayout>
            </ScrollView>
        </Border>
    </Grid>
</ContentPage>
